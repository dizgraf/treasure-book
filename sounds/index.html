<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>–ü–æ–∏—Å–∫ –∫–ª–∞–¥–∞</title>
  <link href="https://fonts.googleapis.com/css2?family=Pirata+One&family=Fredoka:wght@400;600&display=swap" rel="stylesheet">
  <style>
    body { margin: 0; background: linear-gradient(#e7f4ff, #cfe9ff); color: #10324a; font-family: "Fredoka", Arial, sans-serif; text-align: center; }
    h1 { font-family: 'Pirata One', cursive; font-size: 64px; color: gold; text-shadow: 3px 3px 5px black; margin: 20px 0; }
    .topbar { margin: 10px; }
    #musicBtn { padding: 8px 16px; font-size: 18px; border-radius: 10px; border: none; background: #ffcc00; color: #000; cursor: pointer; box-shadow: 0 4px 10px rgba(0,0,0,.2); }
    #musicBtn:hover { background: #ffdd33; }
    #map { position: relative; width: 800px; height: 500px; margin: 20px auto; background: url("images/treasure-map.png") center/cover no-repeat;
           border: 6px solid #fff; border-radius: 16px; box-shadow: 0 6px 18px rgba(0,0,0,.15); }
    .level { position: absolute; width: 60px; height: 60px; border-radius: 50%; border: 4px solid white; display: flex; align-items: center;
             justify-content: center; font-weight: bold; cursor: pointer; background: gray; color: white; transition: transform .2s;
             box-shadow: 0 6px 18px rgba(0,0,0,.15); }
    .level.active { background: gold; color: black; }
    .level:hover { transform: scale(1.1); }
    .page { display: none; }
    .silhouette { width: 200px; margin: 20px auto; filter: grayscale(100%) brightness(50%); }
    .options img { width: 120px; margin: 10px; cursor: pointer; border: 3px solid transparent; border-radius: 10px; transition: transform 0.2s; }
    .options img:hover { border-color: yellow; transform: scale(1.1); }
    .message { font-size: 24px; margin-top: 20px; }
    button { padding: 10px 20px; font-size: 18px; margin-top: 20px; cursor: pointer; border-radius: 10px; border: none; background: #ffcc00; color: #000; }
    canvas { border: 3px dashed white; border-radius: 15px; background: #87CEEB; margin-top: 20px; }
    .firework { position: absolute; width: 5px; height: 5px; border-radius: 50%; background: yellow; animation: explode 1s linear infinite; }
    @keyframes explode { 0% { transform: scale(1); opacity: 1; } 100% { transform: scale(10); opacity: 0; } }
  </style>
</head>
<body>
  <h1>–ü–æ–∏—Å–∫ –∫–ª–∞–¥–∞</h1>

  <div class="topbar">
    <button id="musicBtn" onclick="toggleMusic()">üîä –ú—É–∑—ã–∫–∞</button>
  </div>

  <!-- –ó–≤—É–∫–∏ -->
  <audio id="bgMusic" src="sounds/background.mp3" loop></audio>
  <audio id="applauseSound" src="sounds/applause.mp3"></audio>
  <audio id="victorySound" src="sounds/victory.mp3"></audio>

  <!-- –ö–∞—Ä—Ç–∞ -->
  <div id="map">
    <div class="level active" id="level1" style="top:50px; left:100px;" onclick="openLevel(1)">1</div>
    <div class="level" id="level2" style="top:200px; left:250px;" onclick="openLevel(2)">2</div>
    <div class="level" id="level3" style="top:350px; left:400px;" onclick="openLevel(3)">3</div>
    <div class="level" id="level4" style="top:150px; left:550px;" onclick="openLevel(4)">4</div>
    <div class="level" id="level5" style="top:300px; left:700px;" onclick="openLevel(5)">5</div>
    <div class="level" id="level6" style="top:100px; left:300px;" onclick="openLevel(6)">6</div>
    <div class="level" id="level7" style="top:250px; left:450px;" onclick="openLevel(7)">7</div>
    <div class="level" id="level8" style="top:400px; left:600px;" onclick="openLevel(8)">8</div>
    <div class="level" id="level9" style="top:200px; left:700px;" onclick="openLevel(9)">9</div>
    <div class="level" id="level10" style="top:350px; left:100px;" onclick="openLevel(10)">10</div>
  </div>

  <div id="gameScreen" class="page">
    <h2 id="levelTitle"></h2>
    <div id="taskContainer"></div>
    <div id="message" class="message"></div>
    <button id="nextBtn" style="display:none;" onclick="completeLevel()">–î–∞–ª—å—à–µ</button>
  </div>

  <div id="finalScreen" class="page">
    <h2>üéâ –¢—ã –Ω–∞—à—ë–ª –∫–ª–∞–¥! üéâ</h2>
    <img src="images/treasure-chest.png" width="300" alt="–°—É–Ω–¥—É–∫ —Å –∑–æ–ª–æ—Ç–æ–º">
    <p>–ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º, –æ—Ç–≤–∞–∂–Ω—ã–π –∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å!</p>
  </div>

  <script>
    const bgMusic = document.getElementById("bgMusic");
    const musicBtn = document.getElementById("musicBtn");
    const applauseSound = document.getElementById("applauseSound");
    const victorySound = document.getElementById("victorySound");

    // –ê–≤—Ç–æ—Å—Ç–∞—Ä—Ç –º—É–∑—ã–∫–∏
    window.addEventListener("load", () => {
      bgMusic.volume = 0.5;
      bgMusic.play().catch(() => {
        console.log("–ê–≤—Ç–æ—Å—Ç–∞—Ä—Ç –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω –±—Ä–∞—É–∑–µ—Ä–æ–º. –í–∫–ª—é—á–∏ –≤—Ä—É—á–Ω—É—é.");
      });
    });

    function toggleMusic() {
      if (bgMusic.paused) {
        bgMusic.play();
        musicBtn.textContent = "üîä –ú—É–∑—ã–∫–∞";
      } else {
        bgMusic.pause();
        musicBtn.textContent = "üîá –ú—É–∑—ã–∫–∞";
      }
    }

    let currentLevel = 1;
    function openLevel(level) {
      if (document.getElementById("level" + level).classList.contains("active")) {
        currentLevel = level;
        document.getElementById("map").style.display = "none";
        document.getElementById("gameScreen").style.display = "block";
        document.getElementById("levelTitle").textContent = "–£—Ä–æ–≤–µ–Ω—å " + level;
        loadTask(level);
      }
    }

    function loadTask(level) {
      const task = document.getElementById("taskContainer");
      task.innerHTML = "";
      document.getElementById("message").textContent = "";
      document.getElementById("nextBtn").style.display = "none";

      if (level === 1) {
        task.innerHTML = `<h3>–ö—Ç–æ –∂–∏–≤—ë—Ç –≤ –º–æ—Ä–µ?</h3><img src="images/silhouette-fish.png" class="silhouette">
          <div class="options"><img src="images/octopus.png" onclick="checkAnswer(false)"><img src="images/fish.png" onclick="checkAnswer(true)"><img src="images/starfish.png" onclick="checkAnswer(false)"></div>`;
      }
      if (level === 10) {
        document.getElementById("gameScreen").style.display = "none";
        document.getElementById("finalScreen").style.display = "block";
        victorySound.play();
        launchFireworks();
      }
    }

    function checkAnswer(correct) {
      const msg = document.getElementById("message");
      const nextBtn = document.getElementById("nextBtn");
      if (correct) {
        msg.textContent = "–ú–æ–ª–æ–¥–µ—Ü!";
        nextBtn.style.display = "inline-block";
        applauseSound.play();
      } else {
        msg.textContent = "–ü–æ–ø—Ä–æ–±—É–π –µ—â—ë —Ä–∞–∑!";
      }
    }

    function completeLevel() {
      document.getElementById("gameScreen").style.display = "none";
      document.getElementById("map").style.display = "block";
      let nextLevel = currentLevel + 1;
      if (document.getElementById("level" + nextLevel)) {
        document.getElementById("level" + nextLevel).classList.add("active");
      }
    }

    function launchFireworks() {
      for (let i = 0; i < 20; i++) {
        let fw = document.createElement("div"); fw.className = "firework";
        fw.style.left = Math.random() * window.innerWidth + "px";
        fw.style.top = Math.random() * window.innerHeight + "px";
        document.body.appendChild(fw); setTimeout(() => fw.remove(), 1000);
      }
      setTimeout(launchFireworks, 1500);
    }
  </script>
</body>
</html>
